#!/usr/bin/env zsh

{%@@ if profile == "fedora" @@%}
# load completions from folder
fpath+=(
	"$ZDOTDIR/completions"
	"$HOME/.nodenv/completions"
	"${fpath[@]}"
	)

[[ -f "$ZDOTDIR/completions/_fzf" ]] && source $ZDOTDIR/completions/_fzf
{%@@ elif profile == "mac" @@%}
source /usr/local/Cellar/fzf/*/shell/key-bindings.zsh
source /usr/local/Cellar/fzf/*/shell/completion.zsh

source /usr/local/Cellar/nodenv/*/libexec/../completions/nodenv.zsh

[[ -f $ZDOTDIR/.iterm2_shell_integration.zsh ]] && source $ZDOTDIR/.iterm2_shell_integration.zsh
{%@@ endif @@%}

# Nodenv rehash commands
NODENV_SHELL=zsh
nodenv() {
	local command
	command="${1:-}"
	if [ "$#" -gt 0 ]; then
		shift
	fi

	case "$command" in
	rehash|shell|update)
		eval "$(nodenv "sh-$command" "$@")";;
	*)
		command nodenv "$command" "$@";;
	esac
}

# Enable the "new" completion system (compsys).
autoload -Uz compinit && compinit
[[ -f $ZDOTDIR/.zcompdump ]] && [[ $ZDOTDIR/.zcompdump.zwc -nt $ZDOTDIR/.zcompdump ]] || zcompile $ZDOTDIR/.zcompdump

